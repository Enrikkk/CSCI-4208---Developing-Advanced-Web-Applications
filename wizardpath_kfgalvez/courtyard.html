<html>
    <head>
        <title> RPG Adventure game </title>
        <link rel= "icon" href= "assets/dragon-logo.png" />
    </head>
    <body>
        <h1>Courtyard</h1> 
        <hr>

        <h2> A large, corrupted ogre stands at the center. </h2>
        <img src='assets/corrupted-ogre.gif' width="480">
        <p> "No ordinary weapons will cut through that.."</p>
        <p> You suddenly remember the power within you. You look at your hands, sparking with pure energy.</p>
        
        <h4> What will you do? </h4>

        <!-- begin fight sequence with ogre-->
        <div id = "battleText"></div>

        <div id='options'>
        <button id='Electric blast' onclick='attack()'> Electric Blast </button>
        <a id='wizardPath' href='wizardPath.html'>
            <button> Retreat </button>
        </a>
        <hr>
        <a id= 'dorm' href='wizardPath.html'>Retreat to dorms</a> 
        </div>

        <!-- Display the three doors after defeating the ogre -->
             <!-- Final doors section -->
        <div id="finaldoors" style="display:none; position:relative; width:480px; margin:0 auto;">
            <img src="assets/finaldoors.png" width="480">

            <button style="position:absolute; bottom:10px; left:10px;"
                onclick="location.href='cursedDoor.html?' + queryString" >Cursed</button>
            <button style="position:absolute; bottom:10px; left:170px;"
                onclick="location.href='bossDoor.html?' + queryString">Boss</button>
            <button style="position:absolute; bottom:10px; left:330px;" 
                onclick="location.href='puzzleDoor.html?' + queryString">Puzzle</button>
        </div>

        <hr>
        <iframe src='inventory.html' id=inventory height=100 width=125></iframe>
        <script>
            inventory.src += location.search;
            wizardPath.href += location.search;
            var queryString = new URLSearchParams(location.search);
            var gp = +queryString.get("gp");
            var hp = +queryString.get("hp");
            var ap = +queryString.get("ap");
            var ogreDead = queryString.get('ogreDead') == 'true';
            var ogreHP = 10, ogreAP = 2;

            if (ogreDead){
                options.style.display = "none"; //hide fight options
                document.getElementById('finaldoors').style.display = 'block';
            }
            function attack(){
                ogreHP -= ap;
                if (ogreHP <= 0){
                    queryString.set('gp',gp+3);
                    queryString.set('hp',hp);
                    queryString.set('ogreDead', 'true'); //prevents ogre from respawning
                    inventory.src ='inventory.html?'+queryString;
                    battleText.innerHTML =`You defeated the ogre and come upon 3 doors..`
                    options.style.display = "none"; //hide ui once ogre is dead
                    document.getElementById('finaldoors').style.display = 'flex'; //show the doors
                }
                else {
                    hp -= ogreAP
                    queryString.set('hp',hp);
                    inventory.src ='inventory.html?'+queryString;
                    battleText.innerHTML =`You hit for ${ap} damage, it has ${ogreHP}hp left.<br> You take ${ogreAP} damage.`
                    if (hp <= 0){
                        battleText.innerHTML =`You Died.`
                        options.innerHTML =`<a href= 'index.html'><button>Game Over</button></a>`
                    }
                }
            }
        </script>
    </body>
<html>