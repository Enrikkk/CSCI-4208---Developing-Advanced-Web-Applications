<html>
    <head>
        <title> RPG Adventure game </title>
        <link rel= "icon" href= "assets/dragon-logo.png" />
    </head>
    <body>
        <h1>Library</h1> 
        <hr>

        <h2> Possessed spell books float around the library. </h2>
        <img src='assets/cursed-book.gif' width="480">
        <p>You notice one of the books is glowing..</p>
        
        <h4> What will you do? </h4>

        <div id = "battleText"></div>

        <div id='options'>
        <button id='Wind blast' onclick='attack()'> Fight </button>
        <a id='wizardPath' href='wizardPath.html'>
            <button> Retreat </button>
        </a>
        <hr>
        <a id= 'dorm' href='wizardPath.html'>Retreat to dorms</a> 
        </div>
        <hr>
        <img id="strangekey" src="" width="100" style="display:block;">

        <iframe src='inventory.html' id=inventory height=100 width=125></iframe>
        <script>
            inventory.src += location.search;
            wizardPath.href += location.search;
            var queryString = new URLSearchParams(location.search);
            var gp = +queryString.get("gp");
            var hp = +queryString.get("hp");
            var ap = +queryString.get("ap");
            var keys = +queryString.get("keys");
            var bookHP = 3, bookAP = 2;
            function attack(){
                bookHP -= ap;
                if (bookHP <= 0){
                    strangekey.src ='assets/strangekey.gif';
                    queryString.set('gp',gp+3);
                    queryString.set('hp',hp);
                    queryString.set('keys',keys+1);
                    inventory.src ='inventory.html?'+queryString;
                    battleText.innerHTML =`You destroy the book, and a strange key drops from it..`
                    options.innerHTML =`<a href='wizardPath.html?${queryString}'><button>Go back</button></a>`
                }
                else {
                    hp -= bookAP
                    queryString.set('hp',hp);
                    inventory.src ='inventory.html?'+queryString;
                    battleText.innerHTML =`You hit for ${ap} damage, it has ${bookHP}hp left.<br> You take ${bookAP} damage.}`
                    if (hp <= 0){
                        battleText.innerHTML =`You Died.`
                        options.innerHTML =`<a href= 'index.html'><button>Game Over</button></a>`
                    }
                }
            }
        </script>
    </body>
<html>