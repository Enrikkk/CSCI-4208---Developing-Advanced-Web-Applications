<html>
    <!-- This page will be key in the development of out history, since here an 
         incredibly powerful weapon awaits.
         Once unlocked, true power will invade out knight. -->
    
    <head>
        <title> Triple Adventure </title>
        <link rel="icon" href="assets/weapons/cimitar.png" />
        <link rel="stylesheet" href="styles/styles.css" >
    </head>

    <body>
        <div
            style="background-image: url('assets/garden.png');
                   background-repeat: no-repeat;
                   background-position: center;
                   background-size: cover;
                   width: 100%;
                   height: 100%;"
            id="bg1" >
            
            <h2 id="t1" style="z-index: 100000000000;""> You are now at the royal garden. </h2>
            <h5 id="t2" style="margin-top: -40px; z-index: 100000000000;" > You can see a stone mound which has a massive sword stuck in it. </h5>
            <h5 id="t3" style="margin-top: -20px; z-index: 100000000000;" > There is also a recomforting bonfire next to a big door, which seems sealed. </h5>

            <h3 style="margin-top: -15px;" > What will you do now? </h3>

            <div    id = "bg2"
                    style="background-image: url('assets/gardenLifted.jpeg');
                    background-repeat: no-repeat;
                    background-position: center;
                    background-size: cover;
                    width: 100%;
                    height: 100%;
                    z-index: 1000;
                    opacity: 0;" >
            </div>

            <p> <a id="sword">
                <button onclick="checkSword();"
                        class="smallButton"
                        style="position: absolute;
                               left:10%;
                               bottom: 30%" > Check Altar </button> </a> </p>
            
            <p> <a id="door">
                <button id="doorBtn"
                        onclick="openDoor();"
                        class="smallButton"
                        style="position: absolute;
                               right: 20%;
                               top: 52%" > Use Door </button> </a> </p>

            <p> <a id="rest" href = "knight_rest.html"> 
                <button class="smallButton"
                        style="position: absolute;
                               right: 12%;
                               bottom: 12%" > Lay by the Campfire </button> </a> </p>

            <p> <a id="exit" href = "knight_enter.html"> 
                <button class="exitButton"
                        style="position: absolute;
                               left: 45%;
                               bottom: 12%;" > Exit </button> </a> </p>

            <p class="inventory-title" > Inventory </p>
            <div id="inventory" class="inventory">
                <script src="inventory.js" defer></script>
            </div>
            <div id="flags" class="flagBox">
                <script src="inventory.js" defer></script>
            </div>
        </div>

        <script>
            rest.href += location.search;
            exit.href += location.search;

            // Used to load the proper background image when needed.
            document.addEventListener("DOMContentLoaded", () => {
                if(amountItem("greatSword") > 0) {
                    let backg = document.getElementById("bg1");
                    let t = document.getElementById("t1");
                    let tt = document.getElementById("t2");
                    let ttt = document.getElementById("t3");
                    if(amountItem("doorOpened") > 0) {
                        backg.style.backgroundImage = "url('assets/gardenDoorOpen.png')"
                    } else {
                        backg.style.backgroundImage = "url('assets/gardenLifted.png')"
                    }
                    t.innerHTML="";
                    tt.innerHTML="";
                    ttt.innerHTML="";
                }
            });

            function checkSword() {
                if(amountItem("greatSword") > 0) {
                    window.location.href = "knight_liftedSword.html" + location.search;
                } else {
                    window.location.href = "knight_sword.html" + location.search;
                }
            }

            // Function implemented so that when we are able to, the door can be 
            // unblocked using the royal sword.
            function openDoor() {
                if(amountItem("greatSword") > 0 && amountItem("doorOpened") === 0) {
                    if(confirm("Using the royal sword, you were able to cut through the vegatation that was blocking the door, therefore opening it.")) {
                        addItem("doorOpened", 1);
                    window.location.href="knight_garden.html" + location.search; // Done to recharge the page, updating the background.
                } 
                } else if(amountItem("doorOpened") > 0) {
                    window.location.href = "knight_darkValley.html" + location.search;
                } else {
                    confirm("You tried opening the door cutting the vegetation blocking it, but it seems like your actual sword is not enough\nYou may need a better one...");
                }
            }

        </script>

    </body>

</html>